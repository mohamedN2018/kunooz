{% load static%}
{% load i18n %}
<!DOCTYPE html>
<html lang="ar" dir="rtl" class="{% if request.COOKIES.theme == 'dark' %}dark{% elif request.COOKIES.theme == 'light' %}light{% endif %}">
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-XXXXX"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-XXXXX');
</script>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="description" content="{{ site_settings.site_description|default:'Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø©' }}">
    <meta name="keywords" content="Ø¯ÙˆØ±Ø§Øª, Ù…Ù‚Ø§Ù„Ø§Øª, Ù…Ù†Ø­, ÙƒØªØ¨, ØªØ¹Ù„ÙŠÙ…, Ø§Ù„ØªØ¹Ù„ÙŠÙ…, ØªØ¹Ù„Ù…, Ù…Ù‡Ø§Ø±Ø§Øª">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}{{ site_settings.site_name }}{% endblock %}">
    <meta property="og:description" content="{{ site_settings.site_description|default:'Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø©' }}">
    <meta property="og:image" content="{% block og_image %}{{ site_settings.og_image.url|default:'' }}{% endblock %}">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:type" content="website">


    <title>{% block title %}ÙƒÙ†ÙˆØ²{% endblock %}</title>

    <link rel="icon" href="{% static 'images/favicon.ico' %}" type="image/x-icon">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    

    <!-- GSAP -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø±Ø¨ÙŠ -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <!-- AOS Animation -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
            * {
                font-family: 'Cairo', sans-serif;
                transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease;
            }
            
            body {
                background-color: #f8fafc;
                overflow-x: hidden;
                transition: background-color 0.5s ease;
            }
            
            .dark body {
                background-color: #0f172a !important;
            }
            
            {% comment %} .hero-gradient {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            } {% endcomment %}
            
            .hero-gradient {
                background: linear-gradient(135deg, #3b82f6, #10b981)
            } 
            
            .card-hover:hover {
                transform: translateY(-5px);
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            }
            
            .link-delay-container {
                background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            }
            
            .stat-card {
                background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            }
            
            /* Responsive Navigation */
            @media (max-width: 768px) {
                .nav-container {
                    padding-left: 1rem;
                    padding-right: 1rem;
                }
                
                .nav-links {
                    display: none;
                }
                
                .mobile-menu-btn {
                    display: block;
                }
                
                .user-info span {
                    display: none;
                }
                
                .logo-img {
                    height: 2.5rem !important;
                }
            }
            
            @media (min-width: 769px) and (max-width: 1024px) {
                .nav-container {
                    padding-left: 1.5rem;
                    padding-right: 1.5rem;
                }
                
                .nav-links {
                    gap: 1rem;
                }
                
                .logo-img {
                    height: 3rem !important;
                }
            }
            
            /* Mobile Menu Styles */
            .mobile-menu {
                position: fixed;
                top: 0;
                right: -100%;
                width: 80%;
                max-width: 320px;
                height: 100vh;
                background: white;
                box-shadow: -5px 0 15px rgba(0,0,0,0.1);
                transition: right 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                z-index: 1000;
                padding: 1.5rem;
                overflow-y: auto;
            }
            
            .dark .mobile-menu {
                background: #1e293b !important;
                color: #f1f5f9 !important;
            }
            
            .mobile-menu.active {
                right: 0;
            }
            
            .mobile-menu-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
                z-index: 999;
            }
            
            .dark .mobile-menu-overlay {
                background: rgba(0, 0, 0, 0.7) !important;
            }
            
            .mobile-menu-overlay.active {
                opacity: 1;
                visibility: visible;
            }
            
            /* Animated Background */
            #animated-background {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: -1;
                opacity: 0.3;
            }

            .floating-element {
                position: absolute;
                background: rgba(59, 130, 246, 0.05);
                border-radius: 50%;
                animation: float 20s infinite linear;
            }

            .floating-element:nth-child(1) {
                width: 300px;
                height: 300px;
                top: 10%;
                left: 10%;
                animation-duration: 25s;
                animation-delay: 0s;
            }

            .floating-element:nth-child(2) {
                width: 200px;
                height: 200px;
                top: 60%;
                right: 15%;
                animation-duration: 20s;
                animation-delay: 5s;
            }

            .floating-element:nth-child(3) {
                width: 250px;
                height: 250px;
                bottom: 20%;
                left: 20%;
                animation-duration: 30s;
                animation-delay: 10s;
            }

            @keyframes float {
                0% {
                    transform: translateY(0) rotate(0deg);
                    opacity: 0.5;
                }
                25% {
                    transform: translateY(-20px) rotate(90deg);
                    opacity: 0.7;
                }
                50% {
                    transform: translateY(0) rotate(180deg);
                    opacity: 0.5;
                }
                75% {
                    transform: translateY(20px) rotate(270deg);
                    opacity: 0.3;
                }
                100% {
                    transform: translateY(0) rotate(360deg);
                    opacity: 0.5;
                }
            }

        /* Toggle Buttons */
        .dark-mode-toggle {
            position: fixed;
            bottom: 2rem;
            right: 2rem;              /* ğŸ”¥ Ø«Ø§Ø¨Øª ÙÙŠ ÙŠÙ…ÙŠÙ† Ø§Ù„Ø´Ø§Ø´Ø© */
            
            width: 50px;
            height: 50px;
            border-radius: 50%;
            
            background: linear-gradient(135deg, #3b82f6, #10b981);
            color: white;
            border: none;
            cursor: pointer;
            
            display: flex;
            align-items: center;
            justify-content: center;
            
            font-size: 1.2rem;
            z-index: 999;
            
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
        }

        /* Hover effect */
        .dark-mode-toggle:hover {
            transform: scale(1.08) rotate(8deg);
            box-shadow: 0 12px 35px rgba(59, 130, 246, 0.6);
        }

            .dark .dark-mode-toggle {
                background: linear-gradient(135deg, #f59e0b, #f97316) !important;
            }

            /* Tooltip */
            .dark-mode-toggle .tooltip {
                position: absolute;
                right: 60px;
                background: #1e293b;
                color: #f1f5f9;
                padding: 0.5rem 1rem;
                border-radius: 6px;
                font-size: 0.9rem;
                white-space: nowrap;
                opacity: 0;
                transform: translateX(10px);
                transition: all 0.3s ease;
                pointer-events: none;
                border: 1px solid #475569;
            }

            .dark .dark-mode-toggle .tooltip {
                background: #0f172a;
                color: #cbd5e1;
                border-color: #334155;
            }

            .dark-mode-toggle:hover .tooltip {
                opacity: 1;
                transform: translateX(0);
            }

            /* Back to Top Button */
            .back-to-top {
                position: fixed;
                bottom: 5.5rem;      /* ÙÙˆÙ‚ Ø²Ø± Ø§Ù„Ø¯Ø§Ø±Ùƒ Ù…ÙˆØ¯ Ø¨Ø´ÙˆÙŠØ© */
                right: 2rem;        /* ğŸ”¥ Ø«Ø§Ø¨Øª ÙÙŠ ÙŠÙ…ÙŠÙ† Ø§Ù„Ø´Ø§Ø´Ø© */

                width: 50px;
                height: 50px;
                border-radius: 50%;

                background: linear-gradient(135deg, #10b981, #3b82f6);
                color: white;
                border: none;
                cursor: pointer;

                display: flex;
                align-items: center;
                justify-content: center;

                font-size: 1.2rem;
                z-index: 999;

                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
                transition: all 0.3s ease;

                opacity: 0;
                transform: translateY(20px);
                visibility: hidden;
            }

            /* Ù„Ù…Ø§ ÙŠØ¸Ù‡Ø± */
            .back-to-top.show {
                opacity: 1;
                transform: translateY(0);
                visibility: visible;
            }

            .dark .back-to-top {
                background: linear-gradient(135deg, #3b82f6, #10b981) !important;
            }

            .back-to-top.visible {
                opacity: 1;
                transform: translateY(0);
                visibility: visible;
            }

            /* Hover */
            .back-to-top:hover {
                transform: scale(1.08);
                box-shadow: 0 12px 35px rgba(16, 185, 129, 0.6);
            }

            .back-to-top .tooltip {
                position: absolute;
                right: 60px;
                background: #1e293b;
                color: #f1f5f9;
                padding: 0.5rem 1rem;
                border-radius: 6px;
                font-size: 0.9rem;
                white-space: nowrap;
                opacity: 0;
                transform: translateX(10px);
                transition: all 0.3s ease;
                pointer-events: none;
                border: 1px solid #475569;
            }

            .dark .back-to-top .tooltip {
                background: #0f172a;
                color: #cbd5e1;
                border-color: #334155;
            }

            .back-to-top:hover .tooltip {
                opacity: 1;
                transform: translateX(0);
            }

            /* System Badge */
            .system-badge {
                position: fixed;
                bottom: 9rem;
                right: 1.5rem;
                background: #e5e7eb;
                color: #374151;
                padding: 0.5rem 1rem;
                border-radius: 20px;
                font-size: 0.8rem;
                display: flex;
                align-items: center;
                gap: 0.5rem;
                z-index: 998;
                border: 1px solid #d1d5db;
                transition: all 0.3s ease;
            }

            .dark .system-badge {
                background: #1e293b;
                color: #cbd5e1;
                border-color: #475569;
            }

            /* Custom Scrollbar */
            .dark ::-webkit-scrollbar {
                width: 10px;
            }

            .dark ::-webkit-scrollbar-track {
                background: #1e293b;
            }

            .dark ::-webkit-scrollbar-thumb {
                background: #475569;
                border-radius: 5px;
            }

            .dark ::-webkit-scrollbar-thumb:hover {
                background: #3b82f6;
            }

            /* Selection Color */
            .dark ::selection {
                background-color: #3b82f6;
                color: white;
            }

            /* Responsive Adjustments */
            @media (max-width: 768px) {
                .dark-mode-toggle,
                .back-to-top {
                    bottom: 1rem;
                    left: 1rem;
                    width: 45px;
                    height: 45px;
                    font-size: 1rem;
                }
                
                .dark-mode-toggle {
                    bottom: 5rem;
                }
                
                .system-badge {
                    bottom: 5rem;
                    right: 1rem;
                    font-size: 0.7rem;
                    padding: 0.4rem 0.8rem;
                }
            }

            @media (max-width: 480px) {
                .dark-mode-toggle,
                .back-to-top {
                    width: 40px;
                    height: 40px;
                    font-size: 0.9rem;
                }
                
                .dark-mode-toggle .tooltip,
                .back-to-top .tooltip {
                    font-size: 0.8rem;
                    padding: 0.3rem 0.6rem;
                    right: 50px;
                }
            }

            /* Smooth Dark Mode Transition */
            .dark-mode-transition * {
                transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease !important;
            }

            /* Print Styles */
            @media print {
                .dark-mode-toggle,
                .back-to-top,
                .system-badge {
                    display: none !important;
                }
            }

            /* Footer Responsive Styles */
            @media (max-width: 768px) {
                .footer-grid {
                    grid-template-columns: 1fr !important;
                    gap: 2rem !important;
                }
                
                .footer-section {
                    text-align: center;
                }
                
                .social-icons {
                    justify-content: center !important;
                }
                
                .newsletter-form {
                    flex-direction: column !important;
                }
                
                .newsletter-input {
                    border-radius: 0.5rem !important;
                    margin-bottom: 0.5rem !important;
                }
                
                .newsletter-button {
                    border-radius: 0.5rem !important;
                    width: 100% !important;
                }
            }
            
            @media (min-width: 769px) and (max-width: 1024px) {
                .footer-grid {
                    grid-template-columns: repeat(2, 1fr) !important;
                    gap: 2rem !important;
                }
            }
    </style>
    
    <style>
        /* Ø£Ø¶Ù Ù‡Ø°Ù‡ Ø§Ù„Ø£Ù†Ù…Ø§Ø· ÙÙŠ Ù‚Ø³Ù… extra_css */
        :root {
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --success-color: #28a745;
            --border-radius: 6px;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø·Ø£ */
        .input-error {
            border: 2px solid var(--danger-color) !important;
            background-color: rgba(220, 53, 69, 0.05) !important;
            animation: pulse-danger 2s infinite;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø°ÙŠØ± */
        .input-alert {
            border: 2px solid var(--warning-color) !important;
            background-color: rgba(255, 193, 7, 0.05) !important;
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶ Ù„Ù„Ø­Ù‚ÙˆÙ„ Ø°Ø§Øª Ø§Ù„Ø®Ø·Ø£ */
        @keyframes pulse-danger {
            0% {
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.4);
            }
            70% {
                box-shadow: 0 0 0 6px rgba(220, 53, 69, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0);
            }
        }

        /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù†Ø¨Ø¶ Ù„Ù„Ø­Ù‚ÙˆÙ„ Ø°Ø§Øª Ø§Ù„ØªØ­Ø°ÙŠØ± */
        @keyframes pulse-warning {
            0% {
                box-shadow: 0 0 0 0 rgba(255, 193, 7, 0.4);
            }
            70% {
                box-shadow: 0 0 0 6px rgba(255, 193, 7, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(255, 193, 7, 0);
            }
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª */
        .character-counter {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.85rem;
            margin-top: 4px;
        }

        .character-counter .remaining {
            font-weight: 500;
        }

        .character-counter .over-limit {
            color: var(--danger-color);
            font-weight: bold;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ØªØ­Ø°ÙŠØ± Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø­Ù‚Ù„ */
        .field-status {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            display: none;
        }

        .input-error + .field-status.error,
        .input-alert + .field-status.warning {
            display: block;
        }

        .field-status.error i {
            color: var(--danger-color);
        }

        .field-status.warning i {
            color: var(--warning-color);
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ Ù„Ù„Ù†Øµ ÙÙŠ textarea Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø·Ø£ */
        textarea.input-error::placeholder {
            color: rgba(220, 53, 69, 0.5);
        }

        /* ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ hover Ø¹Ù„Ù‰ Ø§Ù„Ø­Ù‚Ù„ Ø°Ùˆ Ø§Ù„Ø®Ø·Ø£ */
        .input-error:hover {
            background-color: rgba(220, 53, 69, 0.08) !important;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø­Ù‚Ù„ Ù„Ø§Ø­ØªÙˆØ§Ø¡ Ø§Ù„Ø£ÙŠÙ‚ÙˆÙ†Ø© */
        .form-group {
            position: relative;
        }

        .form-group.with-icon input,
        .form-group.with-icon textarea {
            padding-right: 35px;
        }


        
        @keyframes fadeIn {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadeIn {
            animation: fadeIn 1s ease-out forwards;
        }

    </style>
 
    {% block extra_css %}{% endblock %}
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300">
    <!-- Ø²Ø± Dark Mode -->
    <button class="dark-mode-toggle" id="darkModeToggle">
        <i class="fas fa-moon"></i>
        <span class="tooltip">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†</span>
    </button>

    <!-- Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰ -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
        <span class="tooltip">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰</span>
    </button>

    <!-- System Badge -->
    <div class="system-badge" id="systemBadge">
        <i class="fas fa-desktop"></i>
        <span id="modeIndicator">Ø§Ù„Ù†Ø¸Ø§Ù…</span>
    </div>

    <!-- Mobile Menu Overlay -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay"></div>
    
    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="flex justify-between items-center mb-6">
            <div class="flex items-center space-x-2 space-x-reverse">
                <a href="{% url 'home' %}" class="flex items-center gap-2">
                    <img src="{% static 'images/logo.png' %}" class="h-12" alt="Ø§Ù„Ø´Ø¹Ø§Ø±">
                </a>
            </div>
            <button class="text-gray-700 dark:text-gray-300 text-2xl" id="closeMobileMenu">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="space-y-4">
            <a href="{% url 'home' %}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium py-2 border-b border-gray-100 dark:border-gray-700">
                <i class="fas fa-home ml-2"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </a>
            <a href="{% url 'courses' %}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium py-2 border-b border-gray-100 dark:border-gray-700">
                <i class="fas fa-video ml-2"></i> Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª
            </a>
            <a href="{% url 'articles' %}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium py-2 border-b border-gray-100 dark:border-gray-700">
                <i class="fas fa-newspaper ml-2"></i> Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª
            </a>
            <a href="{% url 'grants' %}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium py-2 border-b border-gray-100 dark:border-gray-700">
                <i class="fas fa-award ml-2"></i> Ø§Ù„Ù…Ù†Ø­ ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª
            </a>
            <a href="{% url 'books' %}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium py-2 border-b border-gray-100 dark:border-gray-700">
                <i class="fas fa-book ml-2"></i> Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ù…Ù„Ø®ØµØ§Øª
            </a>
            
            {% if user.is_authenticated %}
                <a href="{% url 'dashboard' %}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium py-2 border-b border-gray-100 dark:border-gray-700">
                    <i class="fas fa-tachometer-alt ml-2"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </a>
                <a href="{% url 'profile' %}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium py-2 border-b border-gray-100 dark:border-gray-700">
                    <i class="fas fa-user ml-2"></i> Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
                </a>
                {% if user.is_staff or user.profile.is_content_editor %}
                <a href="{% url 'create_post' %}" class="block text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium py-2 border-b border-gray-100 dark:border-gray-700">
                    <i class="fas fa-plus-circle ml-2"></i> Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø´ÙˆØ±
                </a>
                {% endif %}
                <form action="{% url 'logout' %}" method="post" class="pt-4">
                    {% csrf_token %}
                    <button type="submit" class="w-full bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/40 py-2 rounded-lg font-medium">
                        <i class="fas fa-sign-out-alt ml-2"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                    </button>
                </form>
            {% else %}
                <div class="pt-4 space-y-2">
                    <a href="{% url 'login' %}" class="block text-center text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium py-2 border border-gray-300 dark:border-gray-700 rounded-lg">
                        <i class="fas fa-sign-in-alt ml-2"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </a>
                    <a href="{% url 'register' %}" class="block text-center bg-gradient-to-r from-blue-500 to-purple-600 text-white py-2 rounded-lg hover:opacity-90 font-medium" onclick="gtag('event','conversion')">
                        <i class="fas fa-user-plus ml-2"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ -->
    <nav class="bg-white dark:bg-gray-800 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 nav-container">
            <div class="flex justify-between items-center py-4">
                <!-- Ø§Ù„Ø´Ø¹Ø§Ø± -->
                <div class="flex items-center space-x-2 space-x-reverse">
                    <a href="{% url 'home' %}" class="flex items-center gap-2">
                        <img src="{% static 'images/logo.png' %}" class="h-16 logo-img" alt="Ø§Ù„Ø´Ø¹Ø§Ø±">
                    </a>
                </div>
                
                <!-- Mobile Menu Button -->
                <button class="md:hidden text-gray-700 dark:text-gray-300 text-xl mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                
                <!-- Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙ†Ù‚Ù„ -->
                <div class="hidden md:flex space-x-8 space-x-reverse nav-links">
                    <a href="{% url 'home' %}" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium {% if request.path == '/' %}text-blue-600 dark:text-blue-400{% endif %}">
                        <i class="fas fa-home mr-1"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                    </a>
                    <a href="{% url 'courses' %}" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium {% if '/courses/' in request.path %}text-blue-600 dark:text-blue-400{% endif %}">
                        <i class="fas fa-video mr-1"></i> Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª
                    </a>
                    <a href="{% url 'articles' %}" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium {% if '/articles/' in request.path %}text-blue-600 dark:text-blue-400{% endif %}">
                        <i class="fas fa-newspaper mr-1"></i> Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª
                    </a>
                    <a href="{% url 'grants' %}" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium {% if '/grants/' in request.path %}text-blue-600 dark:text-blue-400{% endif %}">
                        <i class="fas fa-award mr-1"></i> Ø§Ù„Ù…Ù†Ø­ ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª
                    </a>
                    <a href="{% url 'books' %}" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium {% if '/books/' in request.path %}text-blue-600 dark:text-blue-400{% endif %}">
                        <i class="fas fa-book mr-1"></i> Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ù…Ù„Ø®ØµØ§Øª
                    </a>
                </div>
                
                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
                <div class="hidden md:flex items-center space-x-4 space-x-reverse">
                    {% if user.is_authenticated %}
                    <div class="relative">
                        <!-- Ø²Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
                        <button id="user-menu-btn"
                            class="flex items-center space-x-2 space-x-reverse focus:outline-none select-none">
                            <div class="w-9 h-9 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold">
                                {{ user.first_name|default:user.username|first|upper }}
                            </div>
                            <span class="text-gray-700 dark:text-gray-300 user-info">
                                {{ user.first_name|default:user.username }}
                            </span>
                            <i class="fas fa-chevron-down text-gray-500 dark:text-gray-400 text-sm"></i>
                        </button>

                        <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© -->
                        <div id="user-menu"
                            class="absolute right-0 mt-3 w-52 bg-white dark:bg-gray-800 rounded-xl shadow-2xl py-2
                                border border-gray-100 dark:border-gray-700
                                opacity-0 invisible scale-95
                                transition-all duration-200 origin-top-right z-50">

                            <a href="{% url 'dashboard' %}" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300">
                                <i class="fas fa-tachometer-alt ml-2"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                            </a>

                            <a href="{% url 'profile' %}" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300">
                                <i class="fas fa-user ml-2"></i> Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
                            </a>

                            {% if user.is_staff or user.profile.is_content_editor %}
                            <a href="{% url 'create_post' %}" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300">
                                <i class="fas fa-plus-circle ml-2"></i> Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù†Ø´ÙˆØ±
                            </a>
                            {% endif %}

                            {% if user.is_staff %}
                            <a href="/admin/" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300">
                                <i class="fas fa-cog ml-2"></i> Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
                            </a>
                            {% endif %}

                            <div class="border-t my-2 dark:border-gray-700"></div>

                            <form action="{% url 'logout' %}" method="post">
                                {% csrf_token %}
                                <button type="submit" class="block w-full text-right px-4 py-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20">
                                    <i class="fas fa-sign-out-alt ml-2"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                                </button>
                            </form>
                        </div>
                    </div>
                    {% else %}
                    <a href="{% url 'login' %}" class="text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 font-medium">
                        <i class="fas fa-sign-in-alt ml-1"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </a>

                    <a href="{% url 'register' %}" onclick="gtag('event','conversion')"
                    class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-4 py-2 rounded-lg hover:opacity-90 transition">
                        <i class="fas fa-user-plus ml-1"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </nav>
    
    <!-- Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ -->
    {% if messages %}
    <div class="container mx-auto px-4 mt-4">
        {% for message in messages %}
        <div class="bg-green-100 dark:bg-green-900/20 border border-green-400 dark:border-green-800 text-green-700 dark:text-green-400 px-4 py-3 rounded relative mb-2" role="alert">
            <span class="block sm:inline">{{ message }}</span>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-white dark:bg-gray-900 z-[100] flex items-center justify-center transition-opacity duration-500">
        <div class="text-center">
            <div class="relative w-32 h-32 mx-auto mb-6">
                <div class="absolute inset-0 bg-gradient-to-r from-green-500 to-teal-600 rounded-full animate-pulse"></div>
                <div class="absolute inset-4 bg-white dark:bg-gray-900 rounded-full"></div>
                <div class="absolute inset-0 flex items-center justify-center">
                    <i class="fas fa-book-open text-4xl text-green-600 dark:text-green-400"></i>
                </div>
            </div>
            <div class="text-2xl font-bold text-gray-800 dark:text-white mb-2">Ù…Ù†ØµØ© ÙƒÙ†ÙˆØ²</div>
            <div class="text-gray-600 dark:text-gray-300">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
    </div>

    <!-- Progress Bar -->
    <div id="progressBar" class="fixed top-0 left-0 right-0 h-1 bg-green-600 origin-left transform scale-x-0 z-[9998] transition-transform duration-200"></div>

    <!-- Ø®Ù„ÙÙŠØ© GSAP Ø§Ù„Ù…ØªØ­Ø±ÙƒØ© -->
    <div id="animated-background">
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
    </div>
    
{% comment %} <!-- Left Ad -->
<div class="hidden xl:block fixed left-2 top-24 z-40">
    <iframe src="/ads/render/left_sidebar/"
            class="w-[160px] h-[600px] border-0"></iframe>
</div> {% endcomment %}

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <main class="min-h-screen transition-colors duration-300">   
        {% block content %}{% endblock %}
    </main>
     
{% comment %} <!-- Right Ad -->
<div class="hidden xl:block fixed right-2 top-24 z-40">
    <iframe src="/ads/render/right_sidebar/"
            class="w-[160px] h-[600px] border-0"></iframe>
</div> {% endcomment %}

    <!-- Ø§Ù„ØªØ°ÙŠÙŠÙ„ -->
    <footer class="bg-gray-900 dark:bg-gray-950 text-white py-12 transition-colors duration-300">
        <div class="container mx-auto px-4">
            <div class="footer-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <!-- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ -->
                <div class="footer-section">
                    <div class="flex items-center space-x-2 space-x-reverse mb-4">
                        <a href="{% url 'home' %}" class="flex items-center gap-2">
                             <img src="{% static 'images/logo.png' %}" class="h-16" alt="Ø§Ù„Ø´Ø¹Ø§Ø±">
                        </a>
                    </div>
                    <p class="text-gray-300">
                        Ù…Ù†ØµØ© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¹Ø±Ø¨ÙŠØ© Ø´Ø§Ù…Ù„Ø© ØªÙ‚Ø¯Ù… ÙƒÙˆØ±Ø³Ø§ØªØŒ Ù…Ù‚Ø§Ù„Ø§ØªØŒ Ù…Ù†Ø­ ØªØ¯Ø±ÙŠØ¨ÙŠØ©ØŒ ÙƒØªØ¨ ÙˆÙ…Ù„Ø®ØµØ§Øª Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ø¨Ø§Ø­Ø«ÙŠÙ†.
                    </p>
                </div>
                
                <!-- Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø© -->
                <div class="footer-section">
                    <h4 class="text-xl font-bold mb-4">Ø±ÙˆØ§Ø¨Ø· Ø³Ø±ÙŠØ¹Ø©</h4>
                    <ul class="space-y-2">
                        <li><a href="{% url 'home' %}" class="text-gray-300 hover:text-white transition"><i class="fas fa-chevron-left ml-2"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                        <li><a href="{% url 'courses' %}" class="text-gray-300 hover:text-white transition"><i class="fas fa-chevron-left ml-2"></i> Ø§Ù„ÙƒÙˆØ±Ø³Ø§Øª</a></li>
                        <li><a href="{% url 'articles' %}" class="text-gray-300 hover:text-white transition"><i class="fas fa-chevron-left ml-2"></i> Ø§Ù„Ù…Ù‚Ø§Ù„Ø§Øª</a></li>
                        <li><a href="{% url 'grants' %}" class="text-gray-300 hover:text-white transition"><i class="fas fa-chevron-left ml-2"></i> Ø§Ù„Ù…Ù†Ø­ ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª</a></li>
                        <li><a href="{% url 'books' %}" class="text-gray-300 hover:text-white transition"><i class="fas fa-chevron-left ml-2"></i> Ø§Ù„ÙƒØªØ¨ ÙˆØ§Ù„Ù…Ù„Ø®ØµØ§Øª</a></li>
                    </ul>
                </div>
                
                <!-- Ø³ÙŠØ§Ø³Ø§Øª -->
                <div class="footer-section">
                    <h4 class="text-xl font-bold mb-4">Ø³ÙŠØ§Ø³Ø§Øª</h4>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-300 hover:text-white transition"><i class="fas fa-chevron-left ml-2"></i> Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition"><i class="fas fa-chevron-left ml-2"></i> Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition"><i class="fas fa-chevron-left ml-2"></i> Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</a></li>
                        <li><a href="#" class="text-gray-300 hover:text-white transition"><i class="fas fa-chevron-left ml-2"></i> Ø§ØªØµÙ„ Ø¨Ù†Ø§</a></li>
                    </ul>
                </div>
                
                <!-- ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„ -->
                <div class="footer-section">
                    <h4 class="text-xl font-bold mb-4">ØªØ§Ø¨Ø¹Ù†Ø§</h4>
                    <div class="flex space-x-4 space-x-reverse social-icons mb-4">
                        <a href="{{ url_media.facebook_url }}" class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center hover:bg-blue-700 transition">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="{{ url_media.instagram_url }}" class="w-10 h-10 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full flex items-center justify-center hover:opacity-90 transition">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="{{ url_media.youtube_url }}" class="w-10 h-10 bg-red-600 rounded-full flex items-center justify-center hover:bg-red-700 transition">
                            <i class="fab fa-youtube"></i>
                        </a>
                        <a href="{{ url_media.twitter_url }}" class="w-10 h-10 bg-blue-400 rounded-full flex items-center justify-center hover:bg-blue-500 transition">
                            <i class="fab fa-twitter"></i>
                        </a>
                    </div>
                    <p class="mt-4 text-gray-300 mb-2">
                        Ø§Ø´ØªØ±Ùƒ ÙÙŠ Ù†Ø´Ø±ØªÙ†Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ÙŠØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¢Ø®Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª
                    </p>
                    <div class="mt-2 flex newsletter-form">
                        <input type="email" placeholder="Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" 
                               class="flex-grow px-3 py-2 rounded-r-lg border border-gray-700 bg-gray-800 text-white focus:outline-none focus:ring-2 focus:ring-blue-500 newsletter-input">
                        <button class="bg-gradient-to-r from-blue-500 to-purple-600 px-4 py-2 rounded-l-lg hover:opacity-90 transition newsletter-button">
                            Ø§Ø´ØªØ±Ø§Ùƒ
                        </button>
                    </div>
                </div>
            </div>
            {% comment %} <iframe src="/ads/render/header/" class="w-full" style="border:none;width:100%;height:90px;"></iframe> {% endcomment %}

            <!-- Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù†Ø´Ø± -->
            <div class="border-t border-gray-800 dark:border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>Â© {% now "Y" %} Ù…ÙˆÙ‚Ø¹ ÙƒÙ†ÙˆØ² . Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p> 
                <p class="mt-1"> ØªØµÙ…ÙŠÙ… ÙˆØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© <a href="https://mohamednabilpro.deplois.net/" class="text-blue-500 hover:underline">Ù…Ø­Ù…Ø¯ Ù†Ø¨ÙŠÙ„</a></p>
            </div>
        </div>
    </footer>
    
    <!-- Ù…Ù„ÙØ§Øª JavaScript -->
    <script>
        // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Tailwind CSS
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    },
                    fontFamily: {
                        'cairo': ['Cairo', 'sans-serif'],
                    }
                }
            }
        }
        
        // Mobile Menu Functionality
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const closeMobileMenu = document.getElementById('closeMobileMenu');
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileMenuOverlay = document.getElementById('mobileMenuOverlay');
        
        function openMobileMenu() {
            mobileMenu.classList.add('active');
            mobileMenuOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }
        
        function closeMobileMenuFunc() {
            mobileMenu.classList.remove('active');
            mobileMenuOverlay.classList.remove('active');
            document.body.style.overflow = '';
        }
        
        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', openMobileMenu);
        }
        
        if (closeMobileMenu) {
            closeMobileMenu.addEventListener('click', closeMobileMenuFunc);
        }
        
        if (mobileMenuOverlay) {
            mobileMenuOverlay.addEventListener('click', closeMobileMenuFunc);
        }
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ù‡Ø±ÙˆØ¨
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeMobileMenuFunc();
            }
        });
        
        // GSAP Animations
        document.addEventListener('DOMContentLoaded', function() {
            // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
            gsap.from("nav", {duration: 0.8, y: -50, opacity: 0});
            
            // Wait for DOM to be fully loaded
            console.log('DOM Content Loaded');
        });
        
        // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
        const btn = document.getElementById("user-menu-btn");
        const menu = document.getElementById("user-menu");

        btn?.addEventListener("click", () => {
            menu.classList.toggle("opacity-0");
            menu.classList.toggle("invisible");
            menu.classList.toggle("scale-95");
        });

        document.addEventListener("click", (e) => {
            if (btn && menu && !btn.contains(e.target) && !menu.contains(e.target)) {
                menu.classList.add("opacity-0", "invisible", "scale-95");
            }
        });
        
        // Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ø­Ø³Ø¨ scroll
        const progressBar = document.getElementById("progressBar");
        if (progressBar) {
            const updateProgress = () => {
                const scrollTop = window.scrollY;
                const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrollPercent = docHeight > 0 ? (scrollTop / docHeight) : 0;
                progressBar.style.transform = `scaleX(${scrollPercent})`;
            };

            window.addEventListener("scroll", updateProgress);
            window.addEventListener("resize", updateProgress);
            updateProgress();
        }
        
        // Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø£Ø¹Ù„Ù‰
        const backToTopBtn = document.getElementById("backToTop");
        
        window.addEventListener("scroll", () => {
            if (window.scrollY > 300) {
                backToTopBtn.classList.add("visible");
            } else {
                backToTopBtn.classList.remove("visible");
            }
        });
        
        backToTopBtn.addEventListener("click", () => {
            window.scrollTo({
                top: 0,
                behavior: "smooth"
            });
        });
        
        // Dark Mode System - Simplified and Fixed
        const darkModeToggle = document.getElementById('darkModeToggle');
        const htmlElement = document.documentElement;
        const systemBadge = document.getElementById('systemBadge');
        const modeIndicator = document.getElementById('modeIndicator');

        // Function to set theme
        function setTheme(theme) {
            const isDark = theme === 'dark';
            
            if (isDark) {
                htmlElement.classList.add('dark');
                darkModeToggle.innerHTML = '<i class="fas fa-sun"></i><span class="tooltip">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­</span>';
                modeIndicator.textContent = 'Ø¯Ø§ÙƒÙ†';
                localStorage.setItem('theme', 'dark');
                document.cookie = "theme=dark; path=/; max-age=31536000";
            } else {
                htmlElement.classList.remove('dark');
                darkModeToggle.innerHTML = '<i class="fas fa-moon"></i><span class="tooltip">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†</span>';
                modeIndicator.textContent = 'ÙØ§ØªØ­';
                localStorage.setItem('theme', 'light');
                document.cookie = "theme=light; path=/; max-age=31536000";
            }
        }

        // Initialize theme from localStorage or cookie
        function initTheme() {
            const cookieTheme = document.cookie
                .split('; ')
                .find(row => row.startsWith('theme='))
                ?.split('=')[1];
            
            const storedTheme = localStorage.getItem('theme') || cookieTheme;
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
            
            if (storedTheme) {
                setTheme(storedTheme);
            } else if (prefersDarkScheme) {
                setTheme('dark');
            } else {
                setTheme('light');
            }
        }

        // Toggle theme
        darkModeToggle.addEventListener('click', () => {
            const isDark = htmlElement.classList.contains('dark');
            setTheme(isDark ? 'light' : 'dark');
            
            // Animation effect
            gsap.to(darkModeToggle, {
                rotation: 360,
                duration: 0.5,
                ease: "power2.out",
                onComplete: () => {
                    gsap.set(darkModeToggle, { rotation: 0 });
                }
            });
        });

        // Initialize theme
        initTheme();

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (!localStorage.getItem('theme') && !document.cookie.includes('theme=')) {
                setTheme(e.matches ? 'dark' : 'light');
            }
        });

        // Update system badge
        function updateSystemBadge() {
            const hasStoredTheme = localStorage.getItem('theme') || document.cookie.includes('theme=');
            
            if (hasStoredTheme) {
                systemBadge.innerHTML = '<i class="fas fa-user-cog"></i><span id="modeIndicator">Ù…Ø®ØµØµ</span>';
            } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                systemBadge.innerHTML = '<i class="fas fa-desktop"></i><span id="modeIndicator">Ø§Ù„Ù†Ø¸Ø§Ù…</span>';
            } else {
                systemBadge.innerHTML = '<i class="fas fa-desktop"></i><span id="modeIndicator">Ø§Ù„Ù†Ø¸Ø§Ù…</span>';
            }
        }
        
        updateSystemBadge();
        
        // Ø¥Ø¶Ø§ÙØ© ØªØ£Ø«ÙŠØ± hover Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
        const floatingButtons = [darkModeToggle, backToTopBtn];
        floatingButtons.forEach(btn => {
            if (btn) {
                btn.addEventListener('mouseenter', () => {
                    gsap.to(btn, {
                        scale: 1.1,
                        duration: 0.3,
                        ease: "power2.out"
                    });
                });
                
                btn.addEventListener('mouseleave', () => {
                    gsap.to(btn, {
                        scale: 1,
                        duration: 0.3,
                        ease: "power2.out"
                    });
                });
            }
        });
        
        // ØªØ­Ø³ÙŠÙ† ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø©
        function handleResize() {
            if (window.innerWidth >= 768) {
                closeMobileMenuFunc();
            }
        }
        
        window.addEventListener('resize', handleResize);
        
        // ØªÙ‡ÙŠØ¦Ø© AOS
        if (typeof AOS !== 'undefined') {
            AOS.init({
                duration: 1000,
                once: true,
                offset: 100,
            });
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener("load", function() {
            const overlay = document.getElementById("loading-overlay");
            if (overlay) {
                overlay.classList.add("opacity-0");
                setTimeout(() => overlay.style.display = "none", 500);
            }
        });

        // Smooth scroll Ù„Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;
                
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    e.preventDefault();
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>

    <!-- Search Stats (When typing) -->
    <script>
        const searchInput = document.getElementById('search-input');
        const suggestionsBox = document.getElementById('search-suggestions');

        searchInput.addEventListener('input', function() {
            const term = this.value.trim();
            if (!term) {
                suggestionsBox.innerHTML = '';
                suggestionsBox.classList.add('hidden');
                return;
            }

            fetch(`/autocomplete_search/?term=${encodeURIComponent(term)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.length === 0) {
                        suggestionsBox.innerHTML = '<div class="px-4 py-2 text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬</div>';
                    } else {
                        suggestionsBox.innerHTML = data.map(item => `
                            <a href="${item.url}" 
                            class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 transition">
                                ${item.title}
                            </a>
                        `).join('');
                    }
                    suggestionsBox.classList.remove('hidden');
                })
                .catch(err => {
                    console.error(err);
                    suggestionsBox.classList.add('hidden');
                });
        });

        // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¥Ø°Ø§ Ø¶ØºØ· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø®Ø§Ø±Ø¬ Ø§Ù„Ù€ input
        document.addEventListener('click', function(e) {
            if (!searchInput.contains(e.target) && !suggestionsBox.contains(e.target)) {
                suggestionsBox.classList.add('hidden');
            }
        });

    </script>


 <!-- Search JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('search-input');
            const searchForm = document.getElementById('search-form');
            const searchSuggestions = document.getElementById('search-suggestions');
            const liveResults = document.getElementById('live-search-results');
            const emptyState = document.getElementById('search-empty-state');
            const loadingState = document.getElementById('search-loading');
            const searchStats = document.getElementById('search-stats');
            const resultsCount = document.getElementById('results-count');
            const recentSearchesDiv = document.getElementById('recent-searches');
            const recentSearchesList = document.getElementById('recent-searches-list');

            let searchTimeout;
            let isSearching = false;

            // ØªØ­Ù…ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            function loadRecentSearches() {
                const recent = JSON.parse(localStorage.getItem('recentSearches') || '[]');
                if (recent.length > 0) {
                    recentSearchesDiv.classList.remove('hidden');
                    recentSearchesList.innerHTML = '';
                    
                    recent.slice(0, 5).forEach(term => {
                        const item = document.createElement('div');
                        item.className = 'flex items-center justify-between p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors group';
                        item.innerHTML = `
                            <button onclick="setSearchTerm('${term}')" class="flex-1 text-left">
                                <div class="flex items-center">
                                    <i class="fas fa-history text-gray-400 dark:text-gray-500 ml-2 text-sm"></i>
                                    <span class="text-gray-700 dark:text-gray-300 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
                                        ${term}
                                    </span>
                                </div>
                            </button>
                            <button onclick="removeRecentSearch('${term}')" class="text-gray-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-all">
                                <i class="fas fa-times text-sm"></i>
                            </button>
                        `;
                        recentSearchesList.appendChild(item);
                    });
                } else {
                    recentSearchesDiv.classList.add('hidden');
                }
            }

            // Ø­ÙØ¸ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¨Ø­Ø«
            function saveRecentSearch(term) {
                if (!term.trim()) return;
                
                let recent = JSON.parse(localStorage.getItem('recentSearches') || '[]');
                recent = recent.filter(t => t !== term);
                recent.unshift(term);
                recent = recent.slice(0, 10);
                localStorage.setItem('recentSearches', JSON.stringify(recent));
                loadRecentSearches();
            }

            // ØªØ¹ÙŠÙŠÙ† Ù…ØµØ·Ù„Ø­ Ø§Ù„Ø¨Ø­Ø«
            window.setSearchTerm = function(term) {
                searchInput.value = term;
                searchInput.focus();
                performSearch(term);
            }

            // Ø¥Ø²Ø§Ù„Ø© Ø¨Ø­Ø« Ø³Ø§Ø¨Ù‚
            window.removeRecentSearch = function(term) {
                let recent = JSON.parse(localStorage.getItem('recentSearches') || '[]');
                recent = recent.filter(t => t !== term);
                localStorage.setItem('recentSearches', JSON.stringify(recent));
                loadRecentSearches();
            }

            // Ù…Ø³Ø­ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            window.clearRecentSearches = function() {
                if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ ÙƒÙ„ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©ØŸ')) {
                    localStorage.removeItem('recentSearches');
                    loadRecentSearches();
                }
            }

            // ØªÙ†ÙÙŠØ° Ø§Ù„Ø¨Ø­Ø«
            async function performSearch(query) {
                if (!query.trim() || query.length < 2) {
                    hideSuggestions();
                    return;
                }

                isSearching = true;
                showLoading();

                try {
                    const response = await fetch(`/autocomplete_search/?term=${encodeURIComponent(query)}`);
                    const data = await response.json();

                    if (data.length > 0) {
                        showResults(data);
                        resultsCount.textContent = data.length;
                        searchStats.style.opacity = '1';
                    } else {
                        showEmptyState();
                        resultsCount.textContent = '0';
                        searchStats.style.opacity = '1';
                    }
                } catch (error) {
                    console.error('Search error:', error);
                    showEmptyState();
                } finally {
                    isSearching = false;
                    hideLoading();
                }
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
            function showResults(results) {
                liveResults.innerHTML = '';
                
                results.forEach((item, index) => {
                    const result = document.createElement('a');
                    result.href = item.url;
                    result.className = `block px-6 py-4 hover:bg-gray-50 dark:hover:bg-gray-700/50 
                                    border-b border-gray-100 dark:border-gray-700 last:border-b-0 
                                    transition-colors duration-200 group animate-fadeIn`;
                    result.style.animationDelay = `${index * 50}ms`;
                    
                    result.innerHTML = `
                        <div class="flex items-center">
                            <div class="w-10 h-10 rounded-lg bg-gradient-to-r from-blue-500 to-blue-600 
                                        flex items-center justify-center text-white ml-3">
                                <i class="fas fa-file-alt text-sm"></i>
                            </div>
                            <div class="flex-1">
                                <h5 class="font-medium text-gray-800 dark:text-gray-200 group-hover:text-blue-600 dark:group-hover:text-blue-400 
                                        transition-colors truncate">
                                    ${item.title}
                                </h5>
                                <p class="text-sm text-gray-500 dark:text-gray-400 truncate">
                                    ${item.url.replace(/^https?:\/\//, '').replace(/\/$/, '')}
                                </p>
                            </div>
                            <i class="fas fa-chevron-left text-gray-300 dark:text-gray-600 
                                    group-hover:text-blue-500 dark:group-hover:text-blue-400 
                                    transition-colors transform group-hover:translate-x-1"></i>
                        </div>
                    `;
                    liveResults.appendChild(result);
                });

                showSuggestions();
            }

            // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ù†ØªØ§Ø¦Ø¬
            function showEmptyState() {
                liveResults.innerHTML = '';
                emptyState.classList.remove('hidden');
                showSuggestions();
            }

            // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            function showLoading() {
                loadingState.classList.remove('hidden');
                liveResults.innerHTML = '';
                emptyState.classList.add('hidden');
            }

            // Ø¥Ø®ÙØ§Ø¡ Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            function hideLoading() {
                loadingState.classList.add('hidden');
            }

            // Ø¹Ø±Ø¶ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
            function showSuggestions() {
                searchSuggestions.style.display = 'block';
                setTimeout(() => {
                    searchSuggestions.classList.remove('opacity-0', 'translate-y-2');
                }, 10);
            }

            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª
            function hideSuggestions() {
                searchSuggestions.classList.add('opacity-0', 'translate-y-2');
                searchStats.style.opacity = '0';
                setTimeout(() => {
                    searchSuggestions.style.display = 'none';
                }, 300);
            }

            // Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø¨Ø­Ø«
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                const query = this.value.trim();

                if (query.length < 2) {
                    hideSuggestions();
                    return;
                }

                searchTimeout = setTimeout(() => {
                    performSearch(query);
                }, 300);
            });

            searchInput.addEventListener('focus', function() {
                if (this.value.trim().length >= 2) {
                    performSearch(this.value);
                } else {
                    showSuggestions();
                    liveResults.innerHTML = '';
                    emptyState.classList.add('hidden');
                    searchStats.style.opacity = '0';
                }
            });

            // Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            searchForm.addEventListener('submit', function(e) {
                const query = searchInput.value.trim();
                if (query) {
                    saveRecentSearch(query);
                }
            });

            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            document.addEventListener('click', function(e) {
                if (!searchForm.contains(e.target)) {
                    hideSuggestions();
                }
            });

            // Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    hideSuggestions();
                }
                
                if (e.key === 'Enter' && document.activeElement === searchInput) {
                    saveRecentSearch(searchInput.value.trim());
                }
                
                // Ctrl/Cmd + K Ù„Ù„Ø¨Ø­Ø«
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    searchInput.focus();
                }
            });

            // ØªØ£Ø«ÙŠØ±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
            searchInput.addEventListener('mouseenter', function() {
                this.style.boxShadow = '0 10px 25px rgba(59, 130, 246, 0.15)';
            });

            searchInput.addEventListener('mouseleave', function() {
                this.style.boxShadow = '';
            });

            // ØªØ­Ù…ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø¡
            loadRecentSearches();

            // ØªØ­Ø³ÙŠÙ† Ø§Ù„ÙˆØµÙˆÙ„
            searchInput.setAttribute('aria-label', 'Ø¨Ø­Ø« Ø¹Ù† Ù…Ø­ØªÙˆÙ‰ ØªØ¹Ù„ÙŠÙ…ÙŠ');
            searchInput.setAttribute('aria-describedby', 'search-description');
            
            // Ø¥Ø¶Ø§ÙØ© ÙˆØµÙ Ù„Ù„ÙˆØµÙˆÙ„
            const description = document.createElement('div');
            description.id = 'search-description';
            description.className = 'sr-only';
            description.textContent = 'Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† ÙƒÙˆØ±Ø³Ø§ØªØŒ Ù…Ù‚Ø§Ù„Ø§ØªØŒ Ù…Ù†Ø­ØŒ ÙƒØªØ¨ ÙˆÙ…Ù„Ø®ØµØ§Øª. Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø£Ø³Ù‡Ù… Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª ÙˆØ§Ø¶ØºØ· Enter Ù„Ù„Ø¨Ø­Ø«.';
            searchForm.appendChild(description);
        });

        // CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .animate-fadeIn {
                animation: fadeIn 0.3s ease forwards;
            }
            
            /* Custom scrollbar for search suggestions */
            #search-suggestions::-webkit-scrollbar {
                width: 6px;
            }
            
            #search-suggestions::-webkit-scrollbar-track {
                background: rgba(0, 0, 0, 0.05);
                border-radius: 10px;
            }
            
            #search-suggestions::-webkit-scrollbar-thumb {
                background: rgba(59, 130, 246, 0.3);
                border-radius: 10px;
            }
            
            .dark #search-suggestions::-webkit-scrollbar-track {
                background: rgba(255, 255, 255, 0.05);
            }
            
            .dark #search-suggestions::-webkit-scrollbar-thumb {
                background: rgba(59, 130, 246, 0.5);
            }
            
            /* Focus styles for accessibility */
            #search-input:focus {
                box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.1);
            }
            
            .dark #search-input:focus {
                box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
            }
        `;
        document.head.appendChild(style);
    </script>
 
    
    {% comment %} home eficts {% endcomment %}
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const bg = document.getElementById("hero-bg");
            const overlay = document.getElementById("loading-overlay");
            const progressBar = document.getElementById("progressBar");

            // ØªØ­Ø±ÙŠÙƒ Ø§Ù„Ø®Ù„ÙÙŠØ© Ù…Ø¹ Ø§Ù„Ù…Ø§ÙˆØ³
            if (bg) {
                document.addEventListener("mousemove", function(e) {
                    const x = (window.innerWidth / 2 - e.clientX) / 15;
                    const y = (window.innerHeight / 2 - e.clientY) / 15;
                    bg.style.transform = `translate(${x}px, ${y}px) scale(1.1)`;
                });
            }

            // Ø§Ø®ØªÙØ§Ø¡ Ø§Ù„Ù€ overlay Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            window.addEventListener("load", function() {
                if (overlay) {
                    overlay.classList.add("opacity-0");
                    setTimeout(() => overlay.style.display = "none", 500);
                }
            });

            // Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ø­Ø³Ø¨ scroll
            if (progressBar) {
                const updateProgress = () => {
                    const scrollTop = window.scrollY;
                    const docHeight = document.documentElement.scrollHeight - window.innerHeight;
                    const scrollPercent = docHeight > 0 ? (scrollTop / docHeight) : 0;
                    progressBar.style.transform = `scaleX(${scrollPercent})`;

                    // Ù„Ùˆ Ø¹Ø§ÙŠØ² Ø§Ù„Ø´Ø±ÙŠØ· ÙŠØ®ØªÙÙŠ Ø¹Ù†Ø¯ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø©
                    // if (scrollPercent >= 1) progressBar.style.display = "none";
                };

                // ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø¯ scroll Ø£Ùˆ resize
                window.addEventListener("scroll", updateProgress);
                window.addEventListener("resize", updateProgress);

                // ØªØ­Ø¯ÙŠØ« Ø£ÙˆÙ„ÙŠ
                updateProgress();
            }
        });
    </script>

    {% comment %} Ù†Ø¸Ø§Ù… Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ {% endcomment %}
    <script>
        // ============ Ù†Ø¸Ø§Ù… Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ============
        document.addEventListener('DOMContentLoaded', function() {
            
            // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ ÙˆÙ…Ø¸Ù‡Ø± Ø§Ù„Ø­Ù‚Ù„
            function updateCharacterCounter(field, maxLength) {
                const currentLength = field.value.length;
                const remaining = maxLength - currentLength;
                const fieldName = field.name || field.id;
                const counterId = `${fieldName}_counter`;
                
                // Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¤Ù‡
                let counter = document.getElementById(counterId);
                if (!counter) {
                    counter = document.createElement('div');
                    counter.id = counterId;
                    counter.className = 'character-counter text-muted text-sm mt-1';
                    counter.style.fontSize = '12px';
                    counter.style.minHeight = '20px';
                    counter.style.transition = 'all 0.3s ease';
                    
                    // ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¨Ø¹Ø¯ Ø§Ù„Ø­Ù‚Ù„
                    field.parentNode.insertBefore(counter, field.nextSibling);
                }
                
                // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø§Ù„Ø¹Ø¯Ø§Ø¯
                counter.innerHTML = `
                    <span class="${remaining < 0 ? 'text-danger' : (remaining < 20 ? 'text-warning' : 'text-muted')}">
                        ${remaining} Ø­Ø±Ù Ù…ØªØ¨Ù‚ÙŠØ©
                        ${remaining < 0 ? ` (ØªØ¬Ø§ÙˆØ²Øª Ø§Ù„Ø­Ø¯ Ø¨Ù€ ${Math.abs(remaining)} Ø­Ø±Ù)` : ''}
                    </span>
                `;
                
                // ======== ØªØºÙŠÙŠØ± Ù…Ø¸Ù‡Ø± Ø§Ù„Ø­Ù‚Ù„ Ø­Ø³Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø­Ø±Ù ========
                
                // Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ classes Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø£ÙˆÙ„Ø§Ù‹
                field.classList.remove(
                    'input-valid', 'input-warning', 'input-danger',
                    'border-success', 'border-warning', 'border-danger',
                    'is-valid', 'is-invalid'
                );
                
                if (remaining < 0) {
                    // Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£: ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯
                    field.classList.add('input-danger', 'border-danger', 'is-invalid');
                    field.style.borderWidth = '2px';
                    field.style.borderColor = '#dc3545';
                    field.style.boxShadow = '0 0 0 0.2rem rgba(220, 53, 69, 0.25)';
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø®Ø·Ø£
                    if (!field.parentNode.querySelector('.error-icon')) {
                        const errorIcon = document.createElement('div');
                        errorIcon.className = 'error-icon';
                        errorIcon.innerHTML = 'âŒ';
                        errorIcon.style.position = 'absolute';
                        errorIcon.style.right = '10px';
                        errorIcon.style.top = '50%';
                        errorIcon.style.transform = 'translateY(-50%)';
                        errorIcon.style.color = '#dc3545';
                        errorIcon.style.fontSize = '14px';
                        field.parentNode.style.position = 'relative';
                        field.parentNode.appendChild(errorIcon);
                    }
                    
                } else if (remaining < 10) {
                    // Ø­Ø§Ù„Ø© ØªØ­Ø°ÙŠØ±: Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„Ø­Ø¯
                    field.classList.add('input-warning', 'border-warning');
                    field.style.borderWidth = '2px';
                    field.style.borderColor = '#ffc107';
                    field.style.boxShadow = '0 0 0 0.2rem rgba(255, 193, 7, 0.25)';
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø®Ø·Ø£ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
                    const errorIcon = field.parentNode.querySelector('.error-icon');
                    if (errorIcon) errorIcon.remove();
                    
                } else if (remaining < 20) {
                    // Ø­Ø§Ù„Ø© Ø¥Ù†Ø°Ø§Ø±: Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„ØªØ­Ø°ÙŠØ±
                    field.classList.add('border-warning');
                    field.style.borderWidth = '1px';
                    field.style.borderColor = '#ffc107';
                    field.style.boxShadow = 'none';
                    
                } else {
                    // Ø­Ø§Ù„Ø© Ø¹Ø§Ø¯ÙŠØ©
                    field.style.borderWidth = '1px';
                    field.style.borderColor = '';
                    field.style.boxShadow = 'none';
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø®Ø·Ø£ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙˆØ¬ÙˆØ¯Ø©
                    const errorIcon = field.parentNode.querySelector('.error-icon');
                    if (errorIcon) errorIcon.remove();
                }
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© SEO Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø­Ù‚Ù„ Ù…ØªØ¹Ù„Ù‚Ø§Ù‹ Ø¨Ù€ SEO
                updateSEOPreview(field, remaining);
            }
            
            // Ø¯Ø§Ù„Ø© ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø§ÙŠÙ†Ø© SEO
            function updateSEOPreview(field, remaining) {
                if (field.name === 'seo_title') {
                    const preview = document.getElementById('seoTitlePreview');
                    if (preview) {
                        preview.textContent = field.value || 'Ø¹Ù†ÙˆØ§Ù† SEO Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§';
                        
                        // Ø¥Ø°Ø§ ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ØŒ Ø¬Ø¹Ù„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø­Ù…Ø±Ø§Ø¡
                        if (remaining < 0) {
                            preview.style.color = '#dc3545';
                            preview.style.fontWeight = 'bold';
                        } else {
                            preview.style.color = '';
                            preview.style.fontWeight = '';
                        }
                    }
                }
                
                if (field.name === 'seo_description') {
                    const preview = document.getElementById('seoDescPreview');
                    if (preview) {
                        preview.textContent = field.value || 'ÙˆØµÙ SEO Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§...';
                        
                        // Ø¥Ø°Ø§ ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ØŒ Ø¬Ø¹Ù„ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø­Ù…Ø±Ø§Ø¡
                        if (remaining < 0) {
                            preview.style.color = '#dc3545';
                            preview.style.fontWeight = 'bold';
                        } else {
                            preview.style.color = '';
                            preview.style.fontWeight = '';
                        }
                    }
                }
            }
            
            // ======== ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ ========
            const fields = document.querySelectorAll('input[maxlength], textarea[maxlength]');
            
            fields.forEach(field => {
                const maxLength = parseInt(field.getAttribute('maxlength')) || 0;
                
                if (maxLength > 0) {
                    // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« input
                    field.addEventListener('input', function() {
                        updateCharacterCounter(this, maxLength);
                    });
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« focus Ù„Ù„ØªØ±ÙƒÙŠØ²
                    field.addEventListener('focus', function() {
                        this.style.transition = 'all 0.3s ease';
                    });
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø­Ø¯Ø« blur (Ø¹Ù†Ø¯ Ø®Ø±ÙˆØ¬ Ø§Ù„ØªØ±ÙƒÙŠØ²)
                    field.addEventListener('blur', function() {
                        if (this.value.length <= maxLength) {
                            this.style.boxShadow = 'none';
                        }
                    });
                    
                    // ØªØ­Ø¯ÙŠØ« Ø£ÙˆÙ„ÙŠ
                    updateCharacterCounter(field, maxLength);
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ù†Ø§Ùƒ Ù‚ÙŠÙ…Ø© Ù…Ø³Ø¨Ù‚Ø©
                    if (field.value && field.value.length > maxLength) {
                        updateCharacterCounter(field, maxLength);
                    }
                }
            });
            
            // ======== Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ========
            const form = document.getElementById('postForm');
            if (form) {
                form.addEventListener('submit', function(e) {
                    let hasErrors = false;
                    const errorFields = [];
                    
                    fields.forEach(field => {
                        const maxLength = parseInt(field.getAttribute('maxlength')) || 0;
                        if (field.value.length > maxLength) {
                            hasErrors = true;
                            errorFields.push(field);
                            
                            // Ø¬Ø¹Ù„ Ø§Ù„Ø­Ù‚Ù„ ÙŠÙ‡ØªØ² Ù„Ù„Ø¥Ø´Ø§Ø±Ø© Ù„Ù„Ø®Ø·Ø£
                            field.style.animation = 'shake 0.5s ease-in-out';
                            setTimeout(() => {
                                field.style.animation = '';
                            }, 500);
                            
                            // Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø£ÙˆÙ„ Ø­Ù‚Ù„ Ø¨Ù‡ Ø®Ø·Ø£
                            if (errorFields.length === 1) {
                                field.focus();
                            }
                        }
                    });
                    
                    if (hasErrors) {
                        e.preventDefault();
                        
                        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£
                        showErrorMessage('âš ï¸ Ù‡Ù†Ø§Ùƒ Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ø­Ù‚ÙˆÙ„. Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØµØ­ÙŠØ­Ù‡Ø§ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.');
                    }
                });
            }
            
            // ======== Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ ========
            function showErrorMessage(message) {
                // Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ø±Ø³Ø§Ù„Ø© Ø³Ø§Ø¨Ù‚Ø©
                const oldAlert = document.querySelector('.submit-error-alert');
                if (oldAlert) oldAlert.remove();
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø©
                const alert = document.createElement('div');
                alert.className = 'submit-error-alert alert alert-danger';
                alert.style.position = 'fixed';
                alert.style.top = '20px';
                alert.style.left = '50%';
                alert.style.transform = 'translateX(-50%)';
                alert.style.zIndex = '9999';
                alert.style.maxWidth = '500px';
                alert.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
                alert.innerHTML = `
                    <div class="d-flex align-items-center">
                        <i class="fas fa-exclamation-circle me-2"></i>
                        <span>${message}</span>
                        <button type="button" class="btn-close ms-auto" onclick="this.parentElement.parentElement.remove()"></button>
                    </div>
                `;
                
                document.body.appendChild(alert);
                
                // Ø¥Ø²Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†
                setTimeout(() => {
                    if (alert.parentNode) alert.remove();
                }, 5000);
            }
            
            // ======== CSS Ø¥Ø¶Ø§ÙÙŠ ========
            const style = document.createElement('style');
            style.textContent = `
                /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø© */
                .input-danger {
                    border-color: #dc3545 !important;
                    border-width: 2px !important;
                    background-color: rgba(220, 53, 69, 0.05) !important;
                }
                
                .input-warning {
                    border-color: #ffc107 !important;
                    border-width: 2px !important;
                    background-color: rgba(255, 193, 7, 0.05) !important;
                }
                
                .input-valid {
                    border-color: #28a745 !important;
                    border-width: 1px !important;
                }
                
                /* ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‡Ø² */
                @keyframes shake {
                    0%, 100% { transform: translateX(0); }
                    10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                    20%, 40%, 60%, 80% { transform: translateX(5px); }
                }
                
                /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¹Ø¯Ø§Ø¯ */
                .character-counter {
                    font-size: 12px;
                    margin-top: 4px;
                    min-height: 20px;
                    transition: all 0.3s ease;
                }
                
                /* ØªÙ„Ù…ÙŠØ­ Ù„Ù„Ø£Ø­Ø±Ù Ø§Ù„Ù…ØªØ¬Ø§ÙˆØ²Ø© */
                .character-counter .text-danger::after {
                    content: " âš ï¸";
                }
                
                /* ØªØ£Ø«ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø¨Ù‡ Ø®Ø·Ø£ */
                .input-danger:focus {
                    box-shadow: 0 0 0 0.25rem rgba(220, 53, 69, 0.5) !important;
                }
                
                .input-warning:focus {
                    box-shadow: 0 0 0 0.25rem rgba(255, 193, 7, 0.5) !important;
                }
                
                /* ØªØ­Ø³ÙŠÙ† Ø´ÙƒÙ„ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Øµ */
                .form-control {
                    transition: all 0.3s ease;
                    position: relative;
                }
                
                .form-control:focus {
                    border-color: #86b7fe;
                    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);
                }
                
                /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ Ù„Ù€ textarea */
                textarea.form-control {
                    min-height: 80px;
                    resize: vertical;
                }
                
                /* Ø¥Ø¶Ø§ÙØ© Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø®Ø·Ø£ */
                .form-group {
                    position: relative;
                }
                
                .error-icon {
                    position: absolute;
                    right: 10px;
                    top: 50%;
                    transform: translateY(-50%);
                    color: #dc3545;
                    font-size: 14px;
                    z-index: 10;
                }
                
                /* ØªÙ†Ø³ÙŠÙ‚ Ø®Ø§Øµ Ù„Ø­Ù‚ÙˆÙ„ textarea */
                textarea.form-control + .error-icon {
                    top: 30px;
                }
                
                /* ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯ */
                .text-danger {
                    color: #dc3545 !important;
                    font-weight: bold;
                }
                
                .text-warning {
                    color: #ffc107 !important;
                    font-weight: 500;
                }
                
                .text-muted {
                    color: #6c757d !important;
                }
                
                /* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© */
                .seo-title-preview.text-danger {
                    color: #dc3545 !important;
                }
            `;
            document.head.appendChild(style);
        });

    </script>
    
    {% comment %} # Open Graph Meta Tags {% endcomment %}
    <script type="application/ld+json">
        {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "My Django Website",
        "url": "https://yoursite.com",
        "logo": "https://yoursite.com/static/logo.png"
        }
    </script>
    <script type="application/ld+json">
        {
        "@context": "https://schema.org",
        "@type": "Article",
        "headline": "{{ post.display_title }}",
        "image": "{{ post.get_main_image.url }}",
        "author": {
        "@type": "Person",
        "name": "{{ post.author }}"
        },
        "datePublished": "{{ post.publish_date|date:'Y-m-d' }}",
        "dateModified": "{{ post.updated_at|date:'Y-m-d' }}",
        "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ request.build_absolute_uri }}"
        }
        }
    </script>


    <script src="{% static 'js/clean-paste.js' %}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js" async></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    {% block extra_js %}{% endblock %}
</body>
</html>
